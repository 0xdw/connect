<!DOCTYPE html><html><head><title>Connect - High quality middleware for node.js</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link rel="stylesheet" href="style.css"><script src="jquery.js"></script><script src="docs.js"></script></head><body><div id="content"><h1>Connect</h1><p>High quality middleware for node.js</p><div id="MemoryStore" class="comment"><h2>MemoryStore</h2><div class="description"><p>Initialize a new <code>MemoryStore</code>.</p></div><ul class="tags"></ul><h3>Source</h3><pre><code>var MemoryStore = module.exports = function MemoryStore() {
  this.sessions = {};
};</code></pre></div><div id="MemoryStore.prototype.get" class="comment"><h2>MemoryStore#get()</h2><div class="description"><p>Attempt to fetch session by the given <code>sid</code>.</p></div><ul class="tags"><li><em>String</em> sid </li><li><em>Function</em> fn </li></ul><h3>Source</h3><pre><code>MemoryStore.prototype.get = function(sid, fn){
  var self = this;
  process.nextTick(function(){
    var expires
      , sess = self.sessions[sid];
    if (sess) {
      sess = JSON.parse(sess);
      expires = 'string' == typeof sess.cookie.expires
        ? new Date(sess.cookie.expires)
        : sess.cookie.expires;
      if (!expires || new Date < expires) {
        fn(null, sess);
      } else {
        self.destroy(sid, fn);
      }
    } else {
      fn();
    }
  });
};</code></pre></div><div id="MemoryStore.prototype.set" class="comment"><h2>MemoryStore#set()</h2><div class="description"><p>Commit the given <code>sess</code> object associated with the given <code>sid</code>.</p></div><ul class="tags"><li><em>String</em> sid </li><li><em>Session</em> sess </li><li><em>Function</em> fn </li></ul><h3>Source</h3><pre><code>MemoryStore.prototype.set = function(sid, sess, fn){
  var self = this;
  process.nextTick(function(){
    self.sessions[sid] = JSON.stringify(sess);
    fn && fn();
  });
};</code></pre></div><div id="MemoryStore.prototype.destroy" class="comment"><h2>MemoryStore#destroy()</h2><div class="description"><p>Destroy the session associated with the given <code>sid</code>.</p></div><ul class="tags"><li><em>String</em> sid </li></ul><h3>Source</h3><pre><code>MemoryStore.prototype.destroy = function(sid, fn){
  var self = this;
  process.nextTick(function(){
    delete self.sessions[sid];
    fn && fn();
  });
};</code></pre></div><div id="MemoryStore.prototype.all" class="comment"><h2>MemoryStore#all()</h2><div class="description"><p>Invoke the given callback <code>fn</code> with all active sessions.</p></div><ul class="tags"><li><em>Function</em> fn </li></ul><h3>Source</h3><pre><code>MemoryStore.prototype.all = function(fn){
  var arr = []
    , keys = Object.keys(this.sessions);
  for (var i = 0, len = keys.length; i < len; ++i) {
    arr.push(this.sessions[keys[i]]);
  }
  fn(null, arr);
};</code></pre></div><div id="MemoryStore.prototype.clear" class="comment"><h2>MemoryStore#clear()</h2><div class="description"><p>Clear all sessions.</p></div><ul class="tags"><li><em>Function</em> fn </li></ul><h3>Source</h3><pre><code>MemoryStore.prototype.clear = function(fn){
  this.sessions = {};
  fn && fn();
};</code></pre></div><div id="MemoryStore.prototype.length" class="comment"><h2>MemoryStore#length()</h2><div class="description"><p>Fetch number of sessions.</p></div><ul class="tags"><li><em>Function</em> fn </li></ul><h3>Source</h3><pre><code>MemoryStore.prototype.length = function(fn){
  fn(null, Object.keys(this.sessions).length);
};</code></pre></div></div><ul id="menu"><li><a href="#MemoryStore">MemoryStore</a></li><li><a href="#MemoryStore.prototype.get">MemoryStore#get()</a></li><li><a href="#MemoryStore.prototype.set">MemoryStore#set()</a></li><li><a href="#MemoryStore.prototype.destroy">MemoryStore#destroy()</a></li><li><a href="#MemoryStore.prototype.all">MemoryStore#all()</a></li><li><a href="#MemoryStore.prototype.clear">MemoryStore#clear()</a></li><li><a href="#MemoryStore.prototype.length">MemoryStore#length()</a></li></ul></body></html>